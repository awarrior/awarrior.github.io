<!DOCTYPE html>
<html id="J-html" class="">
<head>
    <meta charset="UTF-8" />
    <title>
        
            Reservoir Sampling
        
    </title>
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="Awarrior" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" media="all" href="http://awarrior.github.io/static/style.css" />
    <link rel="stylesheet" type="text/css" media="all" href="http://awarrior.github.io/static/pygments.css" />
    <!--[if lt IE 9]>
    <script src="http://awarrior.github.io/static/js/html5.js" type="text/javascript"></script>
    <![endif]-->
    <script src="http://awarrior.github.io/static/js/jquery.js" type="text/javascript"></script>
</head>
<body itemscope itemtype="http://schema.org/WebPage" class="home blog lotus index">
    <nav class="lotus-nav">
        <ul>
            
            
            
            
            
                
            
            <li class="home ">
                <a href="/index.html" rel="bookmark" title="Home">
                    <i class="icon-home"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/categories.html" rel="bookmark" title="Categories">
                    <i class="icon-tags"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/archives.html" rel="bookmark" title="Archives">
                    <i class="icon-reorder"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/links.html" rel="bookmark" title="Links">
                    <i class="icon-heart"></i>
                </a>
                
            </li>
            
            
            
            
            
            <li class="">
                <a href="/contact.html" rel="bookmark" title="Author">
                    <i class="icon-user"></i>
                </a>
                
            </li>
            
        </ul>
    </nav>

    <p class="lotus-breadcrub">
    <a href="http://awarrior.github.io/index.html" rel="nofollow" rel="nofollow" title="home">Home</a>
    <span> &gt; </span>
    <!-- <a href="http://awarrior.github.io/archives.html" rel="nofollow" >Archives</a>
    <span> &gt; </span>
    Reservoir Sampling -->
    Post
</p>
<h1 class="lotus-pagetit">Reservoir Sampling</h1>
<p class="lotus-meta">Category: ISSUE &nbsp;|&nbsp;  Publish: <time class="date" pubdate="December  4, 2014">December  4, 2014</time></p>
<article  itemscope itemtype="http://schema.org/Article" class="lotus-post">
<h3 id="describe">Describe</h3>

<p>Sample K elements in N data, and N is not sure.</p>

<p>Imaging one setting: there is one continuous infinite data flow coming one after another, and we can not save the whole data. This situation limits us that the number N of coming data is changeable and we have to keep the randomness in the sampling.</p>

<p>There are many applications existing this problem such as search engine and file search.</p>

<h3 id="resolve">Resolve</h3>

<p>The probability of each element drawing is the same, K/N, N is changeable.</p>

<p>Method 1. Keep K minimum elements</p>

<p>Use one Hash function to generate one random number according to each orignal value. Besides, define an array with K size to save the K minima in the random numbers. If there already are K minima and the new coming number is smaller than the biggest in array, let it swap with the biggest one. </p>

<p>However, this method’s performance is associated with the design of Hash function. That is to say that the mimima may stay at the fixed region and this loses the generality of randomness.</p>

<p>Method 2. Keep K elements using probability</p>

<p>Pick up the first K elements and save them in the array with K size. The NO.K+1 data will be chosen with 1/i (i=K+1,K+2,…,N) probability to swap with one of elements in the array, which is seleted randomly.</p>

<p>Here is the proof:</p>

<hr />
<p>Assume A[i] is the event that element A (saved in array) will leave in the Round i (i=K+1,K+2,…,N); AS is the event that element A will be substituted at this moment; B is the event that the coming new element will replace one of elements in the array; AC is the event that A becomes the element would like to be replaced.</p>

<p>The probability of A[i+1] is:</p>

<p><code>P(A[i+1]) = P(A[i]) * (1 - P(AS))</code><br />
<code>= P(A[i]) * (1 - P(B) * P(AC))</code><br />
<code>= (k/i) * (1 - (k/(i+1)) * (1/k))</code><br />
<code>= (k/(i+1))</code></p>

<p>Q.E.D.</p>

<hr />


</article>
<p class="lotus-anno">Notice: this article use <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="nofollow" target="_blank" title="CC">BY-NC-SA</a> license. Please specify the source: <a href="" title="" rel="nofollow">Awarrior</a></p>
<section class="lotus-nextpage fn-clear">
    
    <div class="lotus-nextpage-left"><a class="prev" href="/maximum-continuous-subset" rel="prev">&laquo;&nbsp;Maximum Continuous Subset</a></div>
    
    
    <div class="lotus-nextpage-right"><a class="next" href="/maximal-difference" rel="next">Maximal Difference&nbsp;&raquo;</a></div>
    
</section>


<script src="http://awarrior.github.io/static/js/jquery.scrollTo.js" type="text/javascript"></script>
<script src="http://awarrior.github.io/static/js/iLotus.js" type="text/javascript"></script>
</body>
</html>
